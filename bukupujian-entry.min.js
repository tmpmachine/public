function handleMiniDate(e){let t=new Date(e).getTime()+-252e5,o=-7-(new Date).getTimezoneOffset()/60,a=new Date((new Date).getTime()+60*o*60*1e3-t-252e5).getTime(),n=Math.floor(a/6048e5),i=Math.floor(a/864e5),l=Math.floor(a/36e5),d=a%36e5,r=Math.floor(d/6e4);return e=i<7&&i>0?i+"d":0==i?l>0?l+"h":r+"m":n>0&&n<4?n+"w":new Date(e).toLocaleString("en",{day:"2-digit",month:"2-digit",year:"2-digit"})}function gantiTampilan(){chordy.toggleLyric($(".post-body")[0],Number(this.checked)),localStorage.setItem("view",Number(this.checked))}function downloadTeks(){let e;e=0==localStorage.getItem("view")?$(".post-body")[0].data.LC.song.map(e=>e[1]).join("\n"):$(".post-body")[0].data.LC.lyric.map(e=>e[1]).join("\n"),$("#in-kapital").checked&&(e=e.toUpperCase());let t=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(t),n=o.cel("a",{download:$("#post-title").textContent,href:a});document.body.appendChild(n),n.click(),document.body.removeChild(n)}function getSongData(e){let t={},o=["bpm","yt"];for(let a of o)e.indexOf("data-"+a)>0&&(t[a]=e.split("data-"+a+'="')[1].split('"')[0]);return t}function postHandler({title:e,date:t,url:a,body:n}){let i=handleMiniDate(t).split("/");i.splice(2,1),i=i.join("-"),isNew=i.includes("h")||i.includes("m");let l=getSongData(n);if(l.yt){let e=o.creps("tmp-module-youtube",{videoId:l.yt});$("#youtube-gallery").innerHTML=e}return{title:e,url:a,body:n,miniDate:i,isNew:isNew?"":"hide"}}let data=getSongData($(".post-body")[0].innerHTML);if(data.yt){let e=o.creps("tmp-module-youtube",{videoId:data.yt});$("#youtube-gallery").innerHTML=e}chordy.init($(".post-body")[0]),null==localStorage.getItem("view")&&localStorage.setItem("view",0),$("#in-tampilan").checked=Boolean(Number(localStorage.getItem("view"))),chordy.toggleLyric($(".post-body")[0],Number(localStorage.getItem("view"))),$("#select-key").value=$(".post-body")[0].data.transposer._baseKey,$("#select-key").options[$(".post-body")[0].data.transposer._baseKey].textContent+="**",chordy.updateTransposer($(".post-body")[0]),o.listen({"btn-download-teks":downloadTeks}),o.listen({"in-tampilan":gantiTampilan},"input");
